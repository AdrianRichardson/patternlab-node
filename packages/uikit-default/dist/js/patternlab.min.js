function receiveIframeMessage(e){var t,n="string"!=typeof e.data?e.data:JSON.parse(e.data);if("file:"==window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)if("patternLab.updatePath"==n.event)if(void 0!==patternData.patternPartial){var o=/(patterns|snapshots)\/(.*)$/;t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(o,"")+n.path+"?"+Date.now(),window.location.replace(t)}else t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+n.path+"?"+Date.now(),window.location.replace(t);else"patternLab.reload"==n.event&&window.location.reload()}var annotationsPattern={commentsOverlayActive:!1,commentsOverlay:!1,commentsEmbeddedActive:!1,commentsEmbedded:!1,commentsGathered:{event:"patternLab.annotationPanel",commentOverlay:"on",comments:[]},trackedElements:[],targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,gatherComments:function(){if(null===document.getElementById("sg-patterns")){var e=0;for(var t in comments.comments){var n=comments.comments[t],o=document.querySelectorAll(n.el);if(o.length>0){e++,n.displaynumber=e;for(var a=0;a<o.length;++a)o[a].onclick=function(e){return function(t){if(annotationsPattern.commentsOverlayActive){t.preventDefault(),t.stopPropagation();var n=JSON.stringify({event:"patternLab.annotationNumberClicked",displaynumber:e.displaynumber,el:e.el,title:e.title,comment:e.comment});parent.postMessage(n,annotationsPattern.targetOrigin)}}}(n)}}}else{var i=JSON.stringify({event:"patternLab.annotationPanel",commentOverlay:"off"});parent.postMessage(i,annotationsPattern.targetOrigin)}},embedComments:function(e,t,n){var o=document.createElement("div");o.classList.add("sg-annotation");var a=document.createElement("h3"),i=document.createElement("p");a.innerHTML=t,i.innerHTML=n,o.appendChild(a),o.appendChild(i);var r=annotationsPattern.findParent(e),s=r.getElementsByClassName("sg-annotations");if(s.length>0)s[0].appendChild(o);else{var c=document.createElement("div");c.classList.add("sg-annotations"),c.appendChild(o),r.appendChild(c)}},findParent:function(e){var t;return e.classList.contains("sg-pattern")?e:e.parentNode.classList.contains("sg-pattern")?e.parentNode:t=annotationsPattern.findParent(e.parentNode)},receiveIframeMessage:function(e){var t,n,o,a,i,r="string"!=typeof e.data?e.data:JSON.parse(e.data);if("file:"==window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)if(void 0!==r.event&&"patternLab.resize"==r.event&&annotationsPattern.commentsOverlayActive)for(t=0;t<annotationsPattern.trackedElements.length;++t){var s=annotationsPattern.trackedElements[t];"0px"==window.getComputedStyle(s.element,null).getPropertyValue("max-height")?(s.element.firstChild.style.display="none",n=JSON.stringify({event:"patternLab.annotationUpdateState",annotationState:!1,displayNumber:s.displayNumber}),parent.postMessage(n,annotationsPattern.targetOrigin)):(s.element.firstChild.style.display="block",n=JSON.stringify({event:"patternLab.annotationUpdateState",annotationState:!0,displayNumber:s.displayNumber}),parent.postMessage(n,annotationsPattern.targetOrigin))}else if(void 0!==r.event&&"patternLab.annotationPanel"==r.event){if(annotationsPattern.commentsOverlayActive=!1,annotationsPattern.commentsEmbeddedActive=!1,"on"===r.commentToggle&&null!==document.getElementById("sg-patterns")?annotationsPattern.commentsEmbeddedActive=!0:"on"===r.commentToggle&&(annotationsPattern.commentsOverlayActive=!0),!annotationsPattern.commentsOverlayActive){for(a=document.querySelectorAll(".has-annotation"),t=0;t<a.length;t++)a[t].classList.remove("has-annotation");for(a=document.querySelectorAll(".annotation-tip"),t=0;t<a.length;t++)a[t].style.display="none"}if(!annotationsPattern.commentsEmbeddedActive)for(a=document.getElementsByClassName("sg-annotations"),t=0;t<a.length;t++)a[t].style.display="none";if(annotationsPattern.commentsOverlayActive){var c=0;for(t=0;t<comments.comments.length;t++)if(i=comments.comments[t],a=document.querySelectorAll(i.el),o=!0,a.length)for(c++,k=0;k<a.length;k++){a[k].classList.add("has-annotation");var l=document.createElement("span");l.innerHTML=c,l.classList.add("annotation-tip"),"0px"==window.getComputedStyle(a[k],null).getPropertyValue("max-height")&&(l.style.display="none",o=!1),annotationsPattern.trackedElements.push({itemel:i.el,element:a[k],displayNumber:c,state:o}),a[k].insertBefore(l,a[k].firstChild)}for(c=0,t=0;t<comments.comments.length;t++)if(o=!0,i=comments.comments[t],a=document.querySelectorAll(i.el),a.length>0){for(c++,k=0;k<a.length;k++)"0px"==window.getComputedStyle(a[k],null).getPropertyValue("max-height")&&(o=!1);var d={el:i.el,title:i.title,comment:i.comment,number:c,state:o};annotationsPattern.commentsGathered.comments.push(d)}n=JSON.stringify(annotationsPattern.commentsGathered),parent.postMessage(n,annotationsPattern.targetOrigin)}else if(annotationsPattern.commentsEmbeddedActive&&!annotationsPattern.commentsEmbedded)for(t=0;t<comments.comments.length;t++)i=comments.comments[t],a=document.querySelectorAll(i.el),a.length>0&&annotationsPattern.embedComments(a[0],i.title,i.comment),annotationsPattern.commentsEmbedded=!0;else if(annotationsPattern.commentsEmbeddedActive&&annotationsPattern.commentsEmbedded)for(a=document.getElementsByClassName("sg-annotations"),t=0;t<a.length;++t)a[t].style.display="block"}}};if(annotationsPattern.gatherComments(),window.addEventListener("message",annotationsPattern.receiveIframeMessage,!1),window.onbeforeunload=function(){var e=JSON.stringify({event:"patternLab.annotationPanel",commentOverlay:"off"});parent.postMessage(e,annotationsPattern.targetOrigin)},jwerty.key("ctrl+shift+a",function(){var e=JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+a"});return parent.postMessage(e,codePattern.targetOrigin),!1}),jwerty.key("esc",function(){var e=JSON.stringify({event:"patternLab.keyPress",keyPress:"esc"});return parent.postMessage(e,codePattern.targetOrigin),!1}),self!=top){var path=window.location.toString(),parts=path.split("?"),options={event:"patternLab.pageLoad",path:parts[0]};options.patternpartial=void 0!==patternData.patternPartial?patternData.patternPartial:"all",""!==patternData.lineage&&(options.lineage=patternData.lineage);var targetOrigin="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);for(var aTags=document.getElementsByTagName("a"),i=0;i<aTags.length;i++)aTags[i].onclick=function(e){var t=this.getAttribute("href"),n=this.getAttribute("target");if(void 0===n||"_parent"!=n&&"_blank"!=n){if(!t||"#"===t)return e.preventDefault(),!1;e.preventDefault(),window.location.replace(t)}else;};for(var keys=["s","m","l","d","h","f"],i=0;i<keys.length;i++)jwerty.key("ctrl+shift+"+keys[i],function(e,t){return function(){var n=JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+"+e});return parent.postMessage(n,t),!1}}(keys[i],targetOrigin));for(var i=0;10>i;)jwerty.key("ctrl+shift+"+i,function(e,t){return function(){var n=("file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+"+e}));return parent.postMessage(n,t),!1}}(i,targetOrigin)),i++}var body=document.getElementsByTagName("body");body[0].onclick=function(){var e="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,t=JSON.stringify({event:"patternLab.bodyClick",bodyclick:"bodyclick"});parent.postMessage(t,e)},window.addEventListener("message",receiveIframeMessage,!1);var annotationsViewer={commentsActive:!1,commentsViewAllActive:!1,targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,moveToOnInit:0,onReady:function(){$("body").addClass("comments-ready"),$(window).resize(function(){annotationsViewer.commentsActive||annotationsViewer.slideComment($("#sg-annotation-container").outerHeight())}),$("#sg-t-annotations").click(function(e){e.preventDefault(),$("#sg-t-toggle").removeClass("active"),annotationsViewer.toggleComments()}),annotationsViewer.commentContainerInit();var e=urlHandler.getRequestVars();void 0===e.view||"annotations"!==e.view&&"a"!==e.view||(annotationsViewer.openComments(),void 0!==e.number&&(annotationsViewer.moveToOnInit=e.number))},toggleComments:function(){annotationsViewer.commentsActive?annotationsViewer.closeComments():annotationsViewer.openComments()},openComments:function(){var e;$("#sg-t-code").removeClass("active"),codeViewer.codeActive=!1,e=JSON.stringify({event:"patternLab.codePanel",codeToggle:"off"}),document.getElementById("sg-viewport").contentWindow.postMessage(e,annotationsViewer.targetOrigin),codeViewer.slideCode(999),e=JSON.stringify({event:"patternLab.annotationPanel",commentToggle:"on"}),document.getElementById("sg-viewport").contentWindow.postMessage(e,annotationsViewer.targetOrigin),annotationsViewer.commentsActive=!0,$("#sg-t-annotations").addClass("active")},closeComments:function(){annotationsViewer.commentsActive=!1;var e=JSON.stringify({event:"patternLab.annotationPanel",commentToggle:"off"});document.getElementById("sg-viewport").contentWindow.postMessage(e,annotationsViewer.targetOrigin),annotationsViewer.slideComment($("#sg-annotation-container").outerHeight()),$("#sg-t-annotations").removeClass("active")},commentContainerInit:function(){null===document.getElementById("sg-annotation-container")&&($('<div id="sg-annotation-container" class="sg-view-container"></div>').html("").appendTo("body").css("bottom",-$(document).outerHeight()),setTimeout(function(){$("#sg-annotation-container").addClass("anim-ready")},50)),$("body").delegate("#sg-annotation-close-btn","click",function(){annotationsViewer.commentsActive=!1,$("#sg-t-annotations").removeClass("active"),annotationsViewer.slideComment($("#sg-annotation-container").outerHeight());var e=JSON.stringify({event:"patternLab.annotationPanel",commentToggle:"off"});return document.getElementById("sg-viewport").contentWindow.postMessage(e,annotationsViewer.targetOrigin),!1})},slideComment:function(e){$("#sg-annotation-container").css("bottom",-e)},moveTo:function(e){if(void 0!==document.getElementById("annotation-"+e)){var t=document.getElementById("annotation-"+e).offsetTop;$("#sg-annotation-container").animate({scrollTop:t-10},600)}},updateComments:function(e){var t=document.getElementById("pl-annotations-template"),n=Hogan.compile(t.innerHTML),o=n.render(e);document.getElementById("sg-annotation-container").innerHTML=o,annotationsViewer.slideComment(0),"0"!=annotationsViewer.moveToOnInit&&(annotationsViewer.moveTo(annotationsViewer.moveToOnInit),annotationsViewer.moveToOnInit="0")},receiveIframeMessage:function(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if(("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)&&void 0!==t.event)if("patternLab.annotationPanel"==t.event)"on"===t.commentOverlay?annotationsViewer.updateComments(t):annotationsViewer.slideComment($("#sg-annotation-container").outerHeight());else if("patternLab.annotationUpdateState"==t.event)document.getElementById("annotation-state-"+t.displayNumber).innerHTML=t.annotationState===!0?"":" hidden";else if("patternLab.annotationNumberClicked"==t.event)annotationsViewer.moveTo(t.displaynumber);else if("patternLab.keyPress"==t.event){if("ctrl+shift+a"==t.keyPress)return annotationsViewer.toggleComments(),!1;if("esc"==t.keyPress&&annotationsViewer.commentsActive)return annotationsViewer.closeComments(),!1}else if("patternLab.pageLoad"==t.event&&annotationsViewer.commentsViewAllActive&&-1!=t.patternpartial.indexOf("viewall-")){var n=JSON.stringify({commentToggle:"on"});document.getElementById("sg-viewport").contentWindow.postMessage(n,annotationsViewer.targetOrigin)}}};$(document).ready(function(){annotationsViewer.onReady()}),window.addEventListener("message",annotationsViewer.receiveIframeMessage,!1),$("#sg-viewport").load(function(){if(annotationsViewer.commentsActive){var e=JSON.stringify({commentToggle:"on"});document.getElementById("sg-viewport").contentWindow.postMessage(e,annotationsViewer.targetOrigin)}}),$("#sg-view li a").click(function(){$(this).parent().parent().removeClass("active"),$(this).parent().parent().parent().parent().removeClass("active")}),jwerty.key("ctrl+shift+a",function(){return annotationsViewer.toggleComments(),!1}),jwerty.key("esc",function(){return annotationsViewer.commentsActive?(annotationsViewer.closeComments(),!1):void 0});var codePattern={codeOverlayActive:!1,codeEmbeddedActive:!1,targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,receiveIframeMessage:function(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if(("file:"==window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)&&void 0!==t.event&&"patternLab.codePanel"==t.event){var n,o;if(codePattern.codeOverlayActive=!1,codePattern.codeEmbeddedActive=!1,"on"==t.codeToggle&&null!==document.getElementById("sg-patterns")?codePattern.codeEmbeddedActive=!0:"on"==t.codeToggle&&(codePattern.codeOverlayActive=!0),!codePattern.codeEmbeddedActive&&null!==document.getElementById("sg-patterns"))for(n=document.getElementsByClassName("sg-code"),o=0;o<n.length;o++)n[o].style.display="none";if(codePattern.codeOverlayActive){var a=JSON.stringify({event:"patternLab.codePanel",codeOverlay:"on",patternData:patternData});parent.postMessage(a,codePattern.targetOrigin)}else if(codePattern.codeEmbeddedActive)for(n=document.getElementsByClassName("sg-code"),o=0;o<n.length;++o)n[o].style.display="block"}}};window.addEventListener("message",codePattern.receiveIframeMessage,!1),window.onbeforeunload=function(){var e=JSON.stringify({event:"patternLab.codePanel",codeOverlay:"off"});parent.postMessage(e,codePattern.targetOrigin)},jwerty.key("ctrl+shift+c",function(){var e=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+c"});return parent.postMessage(e,codePattern.targetOrigin),!1}),jwerty.key("cmd+a/ctrl+a",function(){if(codePattern.codeOverlayActive){var e=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"cmd+a"});return parent.postMessage(e,codePattern.targetOrigin),!1}}),jwerty.key("ctrl+shift+u",function(){var e=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+u"});return parent.postMessage(e,codePattern.targetOrigin),!1}),jwerty.key("ctrl+shift+h",function(){var e=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+h"});return parent.postMessage(e,codePattern.targetOrigin),!1}),jwerty.key("esc",function(){var e=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"esc"});return parent.postMessage(e,codePattern.targetOrigin),!1});var codeViewer={codeActive:!1,tabActive:"e",encoded:"",mustache:"",css:"",ids:{e:"#sg-code-title-html",m:"#sg-code-title-mustache",c:"#sg-code-title-css"},targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,copyOnInit:!1,onReady:function(){$("body").addClass("code-ready"),$(window).resize(function(){codeViewer.codeActive||codeViewer.slideCode($("#sg-code-container").outerHeight())}),$("#sg-t-code").click(function(e){e.preventDefault(),$("#sg-t-toggle").removeClass("active"),$(this).hasClass("active")?codeViewer.closeCode():codeViewer.openCode()}),codeViewer.codeContainerInit();var e=urlHandler.getRequestVars();void 0===e.view||"code"!==e.view&&"c"!==e.view||(codeViewer.copyOnInit=void 0!==e.copy&&"true"===e.copy?!0:!1,codeViewer.openCode())},toggleCode:function(){codeViewer.codeActive?codeViewer.closeCode():codeViewer.openCode()},openCode:function(){var e;$("#sg-t-annotations").removeClass("active"),annotationsViewer.commentsActive=!1,e=JSON.stringify({event:"patternLab.annotationPanel",commentToggle:"off"}),document.getElementById("sg-viewport").contentWindow.postMessage(e,codeViewer.targetOrigin),annotationsViewer.slideComment(999),e=JSON.stringify({event:"patternLab.codePanel",codeToggle:"on"}),document.getElementById("sg-viewport").contentWindow.postMessage(e,codeViewer.targetOrigin),codeViewer.codeActive=!0,$("#sg-t-code").addClass("active")},closeCode:function(){var e=JSON.stringify({event:"patternLab.codePanel",codeToggle:"off"});document.getElementById("sg-viewport").contentWindow.postMessage(e,codeViewer.targetOrigin),codeViewer.codeActive=!1,codeViewer.slideCode($("#sg-code-container").outerHeight()),$("#sg-t-code").removeClass("active")},codeContainerInit:function(){null===document.getElementById("sg-code-container")&&($('<div id="sg-code-container" class="sg-view-container"></div>').html("").appendTo("body").css("bottom",-$(document).outerHeight()),setTimeout(function(){$("#sg-code-container").addClass("anim-ready")},50)),$("body").delegate("#sg-code-close-btn","click",function(){return codeViewer.closeCode(),!1})},swapCode:function(e){codeViewer.clearSelection();var t="",n="c"==e?"css":"markup";$("#sg-code-fill").removeClass().addClass("language-"+n),"m"==e?t=codeViewer.mustache:"e"==e?t=codeViewer.encoded:"c"==e&&(t=codeViewer.css),$("#sg-code-fill").html(t).text(),codeViewer.tabActive=e,Prism.highlightElement(document.getElementById("sg-code-fill")),$(".sg-code-title-active").removeClass("sg-code-title-active"),$(codeViewer.ids[e]).toggleClass("sg-code-title-active")},selectCode:function(){codeViewer.codeActive&&(selection=window.getSelection(),range=document.createRange(),range.selectNodeContents(document.getElementById("sg-code-fill")),selection.removeAllRanges(),selection.addRange(range))},clearSelection:function(){codeViewer.codeActive&&(window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges())},slideCode:function(e){$("#sg-code-container").css("bottom",-e)},saveEncoded:function(){codeViewer.encoded=this.responseText,"e"==codeViewer.tabActive&&codeViewer.activateDefaultTab("e",this.responseText)},saveMustache:function(){codeViewer.mustache=this.responseText,"m"==codeViewer.tabActive&&codeViewer.activateDefaultTab("m",this.responseText)},saveCSS:function(){$("#sg-code-title-css").css("display","block"),codeViewer.css=this.responseText,"c"==codeViewer.tabActive&&codeViewer.activateDefaultTab("c",this.responseText)},activateDefaultTab:function(e,t){var n="",o="c"==e?"css":"markup";"m"==e?n="mustache":"e"==e?n="html":"c"==e&&(n="css"),$(".sg-code-title-active").removeClass("sg-code-title-active"),$("#sg-code-title-"+n).addClass("sg-code-title-active"),$("#sg-code-fill").removeClass().addClass("language-"+o),$("#sg-code-fill").html(t).text(),Prism.highlightElement(document.getElementById("sg-code-fill")),codeViewer.copyOnInit&&(codeViewer.selectCode(),codeViewer.copyOnInit=!1)},updateCode:function(e){codeViewer.clearSelection(),e.lineageExists=!1,0!==e.lineage.length&&(e.lineageExists=!0),e.lineageRExists=!1,0!==e.lineageR.length&&(e.lineageRExists=!0);var t=document.getElementById("pl-code-template"),n=Hogan.compile(t.innerHTML),o=n.render(e);document.getElementById("sg-code-container").innerHTML=o,$("#sg-code-lineage-fill a, #sg-code-lineager-fill a").on("click",function(e){e.preventDefault(),$("#sg-code-loader").css("display","block");var t=JSON.stringify({event:"patternLab.pathUpdate",path:urlHandler.getFileName($(this).attr("data-patternpartial"))});document.getElementById("sg-viewport").contentWindow.postMessage(t,codeViewer.targetOrigin)});var a=urlHandler.getFileName(e.patternPartial),i=new XMLHttpRequest;i.onload=this.saveEncoded,i.open("GET",a.replace(/\.html/,".escaped.html")+"?"+(new Date).getTime(),!0),i.send();var r=new XMLHttpRequest;if(r.onload=this.saveMustache,r.open("GET",a.replace(/\.html/,".mustache")+"?"+(new Date).getTime(),!0),r.send(),e.cssEnabled){var s=new XMLHttpRequest;s.onload=this.saveCSS,s.open("GET",a.replace(/\.html/,".css")+"?"+(new Date).getTime(),!0),s.send()}$(codeViewer.ids.e).click(function(){codeViewer.swapCode("e")}),$(codeViewer.ids.m).click(function(){codeViewer.swapCode("m")}),$(codeViewer.ids.c).click(function(){codeViewer.swapCode("c")}),codeViewer.slideCode(0),$("#sg-code-loader").css("display","none")},receiveIframeMessage:function(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if(("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)&&(void 0!==t.event&&"patternLab.codePanel"==t.event&&("on"===t.codeOverlay?codeViewer.updateCode(t.patternData):codeViewer.slideCode($("#sg-code-container").outerHeight())),void 0!==t.event&&"patternLab.keyPress"==t.event)){if("ctrl+shift+c"==t.keyPress)return codeViewer.toggleCode(),!1;if("cmd+a"==t.keyPress)return codeViewer.selectCode(),!1;if("ctrl+shift+u"==t.keyPress){if(codeViewer.codeActive)return codeViewer.swapCode("m"),!1}else if("ctrl+shift+y"==t.keyPress){if(codeViewer.codeActive)return codeViewer.swapCode("e"),!1}else if("esc"==t.keyPress&&codeViewer.codeActive)return codeViewer.closeCode(),!1}}};$(document).ready(function(){codeViewer.onReady()}),window.addEventListener("message",codeViewer.receiveIframeMessage,!1),$("#sg-viewport").load(function(){if(codeViewer.codeActive){var e=JSON.stringify({event:"patternLab.codePanel",codeToggle:"on"});document.getElementById("sg-viewport").contentWindow.postMessage(e,codeViewer.targetOrigin)}}),jwerty.key("ctrl+shift+c",function(){return codeViewer.toggleCode(),!1}),jwerty.key("cmd+a/ctrl+a",function(){return codeViewer.codeActive?(codeViewer.selectCode(),!1):void 0}),jwerty.key("ctrl+shift+u",function(){return codeViewer.codeActive?(codeViewer.swapCode("m"),!1):void 0}),jwerty.key("ctrl+shift+y",function(){return codeViewer.codeActive?(codeViewer.swapCode("e"),!1):void 0}),jwerty.key("esc",function(){return codeViewer.codeActive?(codeViewer.closeCode(),!1):void 0}),function(e,t,n){function o(e){return e}function a(e){return decodeURIComponent(e.replace(i," "))}var i=/\+/g,r=e.cookie=function(i,s,c){if(s!==n){if(c=e.extend({},r.defaults,c),null===s&&(c.expires=-1),"number"==typeof c.expires){var l=c.expires,d=c.expires=new Date;d.setDate(d.getDate()+l)}return s=r.json?JSON.stringify(s):String(s),t.cookie=[encodeURIComponent(i),"=",r.raw?s:encodeURIComponent(s),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}for(var g=r.raw?o:a,p=t.cookie.split("; "),m=0,u=p.length;u>m;m++){var v=p[m].split("=");if(g(v.shift())===i){var w=g(v.join("="));return r.json?JSON.parse(w):w}}return null};r.defaults={},e.removeCookie=function(t,n){return null!==e.cookie(t)?(e.cookie(t,null,n),!0):!1}}(jQuery,document);var DataSaver={cookieName:"patternlab",addValue:function(e,t){var n=$.cookie(this.cookieName);n=null===n||""===n?e+"~"+t:n+"|"+e+"~"+t,$.cookie(this.cookieName,n)},updateValue:function(e,t){if(this.findValue(e)){for(var n="",o=$.cookie(this.cookieName).split("|"),a=0;a<o.length;a++){var i=o[a].split("~");i[0]==e&&(i[1]=t),n+=a>0?"|"+i[0]+"~"+i[1]:i[0]+"~"+i[1]}$.cookie(this.cookieName,n)}else this.addValue(e,t)},removeValue:function(e){for(var t="",n=$.cookie(this.cookieName).split("|"),o=0,a=0;a<n.length;a++){var i=n[a].split("~");i[0]!=e&&(t+=0===o?i[0]+"~"+i[1]:"|"+i[0]+"~"+i[1],o++)}$.cookie(this.cookieName,t)},findValue:function(e){if($.cookie(this.cookieName))for(var t=$.cookie(this.cookieName).split("|"),n=0;n<t.length;n++){var o=t[n].split("~");if(o[0]==e)return o[1]}return!1}},template=document.getElementById("pl-pattern-nav-template"),templateCompiled=Hogan.compile(template.innerHTML),templateRendered=templateCompiled.render(navItems);document.getElementById("pl-pattern-nav-target").innerHTML=templateRendered;var template=document.getElementById("pl-ish-controls-template"),templateCompiled=Hogan.compile(template.innerHTML),templateRendered=templateCompiled.render(ishControls);document.getElementById("sg-controls").innerHTML=templateRendered;var urlHandler={skipBack:!1,targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,getFileName:function(e){var t="patterns",n="";if(void 0===e)return n;if("all"==e)return"styleguide/html/styleguide.html";if("snapshots"==e)return"snapshots/index.html";var o=-1!=e.indexOf("viewall-")?viewAllPaths:patternPaths,a=e.replace("viewall-",""),i=this.getPatternInfo(a,o),r=i[0],s=i[1];if(void 0!==o[r]&&void 0!==o[r][s])n=o[r][s];else if(void 0!==o[r])for(var c in o[r])if(-1!=c.indexOf(s)){n=o[r][c];break}if(""===n)return n;var l=/\//g;return-1!=e.indexOf("viewall-")&&""!==n?n=t+"/"+n.replace(l,"-")+"/index.html":""!==n&&(n=t+"/"+n.replace(l,"-")+"/"+n.replace(l,"-")+".html"),n},getPatternInfo:function(e,t){for(var n=e.split("-"),o=1,a=n.length,i=n[0];void 0===t[i]&&a>o;)i+="-"+n[o],o++;var r=e.slice(i.length+1,e.length);return[i,r]},getRequestVars:function(){var e=new function(e){if(e.length>1)for(var t,n=0,o=e.substr(1).split("&");n<o.length;n++)t=o[n].split("="),this[unescape(t[0])]=t.length>1?unescape(t[1]):""}(window.location.search);return e},pushPattern:function(e,t){var n={pattern:e},o=urlHandler.getFileName(e),a=window.location.pathname;a="file"===window.location.protocol?a.replace("/public/index.html","public/"):a.replace(/\/index\.html/,"/");var i=window.location.protocol+"//"+window.location.host+a+o;if(t!=i){var r=JSON.stringify({event:"patternLab.updatePath",path:o});document.getElementById("sg-viewport").contentWindow.postMessage(r,urlHandler.targetOrigin)}else{var s="file:"==window.location.protocol?null:window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+"?p="+e;void 0!==history.pushState&&history.pushState(n,null,s),document.getElementById("title").innerHTML="Pattern Lab - "+e,void 0!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(e))}},popPattern:function(e){var t,n=e.state;if(null===n)return void(this.skipBack=!1);null!==n&&(t=n.pattern);var o="";o=this.getFileName(t),""===o&&(o="styleguide/html/styleguide.html");var a=JSON.stringify({event:"patternLab.updatePath",path:o});document.getElementById("sg-viewport").contentWindow.postMessage(a,urlHandler.targetOrigin),document.getElementById("title").innerHTML="Pattern Lab - "+t,document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(t)),wsnConnected&&wsn.send('{"url": "'+o+'", "patternpartial": "'+t+'" }')}};window.onpopstate=function(e){urlHandler.skipBack=!0,urlHandler.popPattern(e)};var patternFinder={data:[],active:!1,init:function(){for(var e in patternPaths)if(patternPaths.hasOwnProperty(e))for(var t in patternPaths[e]){var n={};n.patternPartial=e+"-"+t,n.patternPath=patternPaths[e][t],this.data.push(n)}var o=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.nonword(e.patternPartial)},queryTokenizer:Bloodhound.tokenizers.nonword,limit:10,local:this.data});o.initialize(),$("#sg-find .typeahead").typeahead({highlight:!0},{displayKey:"patternPartial",source:o.ttAdapter()}).on("typeahead:selected",patternFinder.onAutocompleted).on("typeahead:autocompleted",patternFinder.onSelected)},passPath:function(e){patternFinder.closeFinder();var t=JSON.stringify({event:"patternLab.updatePath",path:urlHandler.getFileName(e.patternPartial)});document.getElementById("sg-viewport").contentWindow.postMessage(t,urlHandler.targetOrigin)},onSelected:function(e,t){patternFinder.passPath(t)},onAutocompleted:function(e,t){patternFinder.passPath(t)},toggleFinder:function(){patternFinder.active?patternFinder.closeFinder():patternFinder.openFinder()},openFinder:function(){patternFinder.active=!0,$("#sg-find .typeahead").val(""),$("#sg-find").addClass("show-overflow"),$("#sg-find .typeahead").focus()},closeFinder:function(){patternFinder.active=!1,$("#sg-find").removeClass("show-overflow"),$(".sg-acc-handle, .sg-acc-panel").removeClass("active"),$("#sg-find .typeahead").val("")},receiveIframeMessage:function(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)return void 0!==t.keyPress&&"ctrl+shift+f"==t.keyPress?(patternFinder.toggleFinder(),!1):void 0}};patternFinder.init(),window.addEventListener("message",patternFinder.receiveIframeMessage,!1),$("#sg-find .typeahead").focus(function(){patternFinder.active||patternFinder.openFinder()}),$("#sg-find .typeahead").blur(function(){patternFinder.closeFinder()}),jwerty.key("ctrl+shift+f",function(){return $(".sg-find .sg-acc-handle, .sg-find .sg-acc-panel").addClass("active"),patternFinder.toggleFinder(),!1}),function(e){function t(){var e=$(".sg-acc-panel.active").first(),t=(e.height(),h-E);e.height(t)}function n(){r(),c(),d(m(y,500))}function o(){r(),c(),d(m(500,800))}function a(){r(),c(),d(m(800,1200))}function i(){d(m(y,f))}function r(){S=!1,clearInterval(L),L=!1}function s(){S=!0,L=setInterval(i,800)}function c(){var e=C.width();I=!1,C.removeClass("hay-mode"),$("#sg-gen-container").removeClass("hay-mode"),d(Math.floor(e))}function l(){I=!0,$("#sg-gen-container").removeClass("vp-animate").width(y+P),C.removeClass("vp-animate").width(y);window.setTimeout(function(){$("#sg-gen-container").addClass("hay-mode").width(k+P),C.addClass("hay-mode").width(k),setInterval(function(){var e=C.width();p(e)},100)},200)}function d(e,t){var n;n=e>k?k:y>e?y:e,t===!1?$("#sg-gen-container,#sg-viewport").removeClass("vp-animate"):$("#sg-gen-container,#sg-viewport").addClass("vp-animate"),$("#sg-gen-container").width(n+P),C.width(n);var o="file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,a=JSON.stringify({event:"patternLab.resize",resize:"true"});document.getElementById("sg-viewport").contentWindow.postMessage(a,o),p(n),g(n)}function g(e){DataSaver.findValue("vpWidth")?DataSaver.updateValue("vpWidth",e):DataSaver.addValue("vpWidth",e)}function p(e,t,n){var o,a;"em"===t?(o=e,a=Math.floor(e*O)):(a=e,o=e/O),"updatePxInput"===n?b.val(a):"updateEmInput"===n?V.val(o.toFixed(2)):(V.val(o.toFixed(2)),b.val(a))}function m(e,t){return Math.floor(Math.random()*(t-e)+e)}function u(e){$("#sg-viewport").width(e),$("#sg-gen-container").width(1*e+14),p(e)}function v(){$(".sg-nav-container, .sg-nav-toggle, .sg-acc-handle, .sg-acc-panel").removeClass("active"),patternFinder.closeFinder()}function w(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host)if("patternLab.bodyclick"==t.event)v();else if("patternLab.pageLoad"==t.event){if(!urlHandler.skipBack&&((void 0===history.state||null===history.state||history.state.pattern!==t.patternpartial)&&urlHandler.pushPattern(t.patternpartial,t.path),wsnConnected)){var i=urlHandler.getFileName(t.patternpartial);wsn.send('{"url": "'+i+'", "patternpartial": "'+e.data.patternpartial+'" }')}urlHandler.skipBack=!1}else if("patternLab.keyPress"==t.event){if("ctrl+shift+s"==t.keyPress)n();else if("ctrl+shift+m"==t.keyPress)o();else if("ctrl+shift+l"==t.keyPress)a();else if("ctrl+shift+d"==t.keyPress)S?r():s();else if("ctrl+shift+h"==t.keyPress)I?c():l();else if("ctrl+shift+0"==t.keyPress)d(320,!0);else if(found=t.keyPress.match(/ctrl\+shift\+([1-9])/)){var g=N[found[1]-1],p=-1!==g.indexOf("px")?"px":"em";g=g.replace(p,"");var m="px"===p?1*g:g*O;d(m,!0)}return!1}}var f=document.body.clientWidth,h=$(document).height(),y=parseInt(config.ishminimum),k=parseInt(config.ishmaximum),P=14,C=$("#sg-viewport"),b=$(".sg-size-px"),V=$(".sg-size-em"),O=parseInt($("body").css("font-size")),E=$(".sg-header").height(),L=!1,S=!1,I=!1;$(e).resize(function(){f=document.body.clientWidth,h=$(document).height(),t()}),$(".sg-acc-handle").on("click",function(e){e.preventDefault();var n=$(this),o=n.next(".sg-acc-panel"),a=n.parent().parent().hasClass("sg-acc-panel");a||($(".sg-acc-handle").not(n).removeClass("active"),$(".sg-acc-panel").not(o).removeClass("active")),n.toggleClass("active"),o.toggleClass("active"),t()
}),$(".sg-nav-toggle").on("click",function(e){e.preventDefault(),$(".sg-nav-container").toggleClass("active")}),$("#sg-t-toggle").on("click",function(e){e.preventDefault(),$(this).parents("ul").toggleClass("active")}),$("#sg-size-toggle").on("click",function(e){e.preventDefault(),$(this).parents("ul").toggleClass("active")}),$(".sg-size[data-size]").on("click",function(e){e.preventDefault(),r(),c();var t=$(this).attr("data-size");t.indexOf("px")>-1&&(O=1),t=t.replace(/[^\d.-]/g,""),d(Math.floor(t*O))}),$("#sg-size-s").on("click",function(e){e.preventDefault(),n()}),jwerty.key("ctrl+shift+s",function(){return n(),!1}),$("#sg-size-m").on("click",function(e){e.preventDefault(),o()}),jwerty.key("ctrl+shift+m",function(){return a(),!1}),$("#sg-size-l").on("click",function(e){e.preventDefault(),a()}),jwerty.key("ctrl+shift+l",function(){return a(),!1}),$("#sg-size-full").on("click",function(e){e.preventDefault(),r(),c(),d(f)}),$("#sg-size-random").on("click",function(e){e.preventDefault(),r(),c(),d(m(y,f))}),$("#sg-size-disco").on("click",function(e){e.preventDefault(),c(),S?r():s()}),jwerty.key("ctrl+shift+d",function(){return S?r():s(),!1}),$("#sg-size-hay").on("click",function(e){e.preventDefault(),r(),I?c():l()}),jwerty.key("ctrl+shift+h",function(){I?c():l()}),b.on("keydown",function(e){var t=Math.floor($(this).val());38===e.keyCode?(t++,d(t,!1)):40===e.keyCode?(t--,d(t,!1)):13===e.keyCode&&(e.preventDefault(),d(t),$(this).blur())}),b.on("keyup",function(){var e=Math.floor($(this).val());p(e,"px","updateEmInput")}),V.on("keydown",function(e){var t=parseFloat($(this).val());38===e.keyCode?(t++,d(Math.floor(t*O),!1)):40===e.keyCode?(t--,d(Math.floor(t*O),!1)):13===e.keyCode&&(e.preventDefault(),d(Math.floor(t*O)))}),V.on("keyup",function(){var e=parseFloat($(this).val());p(e,"em","updatePxInput")}),jwerty.key("ctrl+shift+0",function(e){return e.preventDefault(),d(320,!0),!1});var N=[];$("#sg-mq a").each(function(e){N.push($(this).html()),$(this).on("click",function(e,t){return function(e){e.preventDefault();var n=$(t).html(),o=-1!==n.indexOf("px")?"px":"em";n=n.replace(o,"");var a="px"===o?1*n:n*O;d(a,!0)}}(e,this)),jwerty.key("ctrl+shift+"+(e+1),function(e){return function(){var t=$(e).html(),n=-1!==t.indexOf("px")?"px":"em";t=t.replace(n,"");var o="px"===n?1*t:t*O;return d(o,!0),!1}}(this))}),$("#sg-gen-container").on("transitionend webkitTransitionEnd",function(){var e="file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,t=JSON.stringify({event:"patternLab.resize",resize:"true"});document.getElementById("sg-viewport").contentWindow.postMessage(t,e)}),$("#sg-gen-container").on("touchstart",function(){}),$("#sg-rightpull").mousedown(function(e){var t=e.clientX,n=C.width();return $("#sg-cover").css("display","block"),$("#sg-cover").mousemove(function(e){var o;o=n+2*(e.clientX-t),o>y&&(DataSaver.findValue("vpWidth")?DataSaver.updateValue("vpWidth",o):DataSaver.addValue("vpWidth",o),d(o,!1))}),!1}),$("body").mouseup(function(){$("#sg-cover").unbind("mousemove"),$("#sg-cover").css("display","none")});var M=$("#sg-viewport").width();$("#sg-gen-container").width(M);var A=screen.width;void 0!==window.orientation&&(A=0===window.orientation?screen.width:screen.height),$(window).width()==A&&"ontouchstart"in document.documentElement&&$(window).width()<=1024?$("#sg-rightpull-container").width(0):$("#sg-viewport").width(M-14),p($("#sg-viewport").width());var T=urlHandler.getRequestVars(),B=0,x=!0;void 0!==T.h||void 0!==T.hay?l():void 0!==T.d||void 0!==T.disco?s():void 0!==T.w||void 0!==T.width?(B=void 0!==T.w?T.w:T.width,B=Math.floor(-1!==B.indexOf("em")?Math.floor(B.replace("em",""))*O:B.replace("px","")),DataSaver.updateValue("vpWidth",B),u(B)):x&&(B=DataSaver.findValue("vpWidth"))&&u(B);var H="all",D="",F=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+"styleguide/html/styleguide.html?"+Date.now();if((void 0!==T.p||void 0!==T.pattern)&&(H=void 0!==T.p?T.p:T.pattern,D=urlHandler.getFileName(H),F=""!==D?window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+D+"?"+Date.now():F),"all"!==H&&(document.getElementById("title").innerHTML="Pattern Lab - "+H,history.replaceState({pattern:H},null,null)),void 0!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(H)),urlHandler.skipBack=!0,document.getElementById("sg-viewport").contentWindow.location.replace(F),$("a[data-patternpartial]").on("click",function(e){e.preventDefault();var t=JSON.stringify({event:"patternLab.updatePath",path:urlHandler.getFileName($(this).attr("data-patternpartial"))});document.getElementById("sg-viewport").contentWindow.postMessage(t,urlHandler.targetOrigin),v()}),$("#sg-vp-wrap").click(function(){v()}),void 0!==window.orientation){var J=window.orientation;window.addEventListener("orientationchange",function(){window.orientation!=J&&($("#sg-gen-container").width($(window).width()),$("#sg-viewport").width($(window).width()),p($(window).width()),J=window.orientation)},!1)}window.addEventListener("message",w,!1)}(this);