function receiveIframeMessage(t){if("file:"==window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var e,n={};try{n="string"!=typeof t.data?t.data:JSON.parse(t.data)}catch(a){}if(void 0!==n.event&&"patternLab.updatePath"==n.event)if(void 0!==patternData.patternPartial){var o=/(patterns|snapshots)\/(.*)$/;e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(o,"")+n.path+"?"+Date.now(),window.location.replace(e)}else e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+n.path+"?"+Date.now(),window.location.replace(e);else void 0!==n.event&&"patternLab.reload"==n.event&&window.location.reload()}}if(self!=top){var path=window.location.toString(),parts=path.split("?"),options={event:"patternLab.pageLoad",path:parts[0]};options.patternpartial=void 0!==patternData.patternPartial?patternData.patternPartial:"all",""!==patternData.lineage&&(options.lineage=patternData.lineage);var targetOrigin="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);for(var aTags=document.getElementsByTagName("a"),i=0;i<aTags.length;i++)aTags[i].onclick=function(t){var e=this.getAttribute("href"),n=this.getAttribute("target");if(void 0===n||"_parent"!=n&&"_blank"!=n){if(!e||"#"===e)return t.preventDefault(),!1;t.preventDefault(),window.location.replace(e)}else;}}var body=document.getElementsByTagName("body");body[0].onclick=function(){var t="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,e=JSON.stringify({event:"patternLab.bodyClick",bodyclick:"bodyclick"});parent.postMessage(e,t)},window.addEventListener("message",receiveIframeMessage,!1);var urlHandler={skipBack:!1,targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,getFileName:function(t){var e="patterns",n="";if(void 0===t)return n;if("all"==t)return"styleguide/html/styleguide.html";if("snapshots"==t)return"snapshots/index.html";var a=-1!=t.indexOf("viewall-")?viewAllPaths:patternPaths,o=t.replace("viewall-",""),i=this.getPatternInfo(o,a),l=i[0],r=i[1];if(void 0!==a[l]&&void 0!==a[l][r])n=a[l][r];else if(void 0!==a[l])for(var d in a[l])if(-1!=d.indexOf(r)){n=a[l][d];break}if(""===n)return n;var s=/\//g;return-1!=t.indexOf("viewall-")&&""!==n?n=e+"/"+n.replace(s,"-")+"/index.html":""!==n&&(n=e+"/"+n.replace(s,"-")+"/"+n.replace(s,"-")+".html"),n},getPatternInfo:function(t,e){for(var n=t.split("-"),a=1,o=n.length,i=n[0];void 0===e[i]&&o>a;)i+="-"+n[a],a++;var l=t.slice(i.length+1,t.length);return[i,l]},getRequestVars:function(){var t=new function(t){if(t.length>1)for(var e,n=0,a=t.substr(1).split("&");n<a.length;n++)e=a[n].split("="),this[unescape(e[0])]=e.length>1?unescape(e[1]):""}(window.location.search);return t},pushPattern:function(t,e){var n={pattern:t},a=urlHandler.getFileName(t),o=window.location.pathname;o="file"===window.location.protocol?o.replace("/public/index.html","public/"):o.replace(/\/index\.html/,"/");var i=window.location.protocol+"//"+window.location.host+o+a;if(e!=i){var l=JSON.stringify({event:"patternLab.updatePath",path:a});document.getElementById("sg-viewport").contentWindow.postMessage(l,urlHandler.targetOrigin)}else{var r="file:"==window.location.protocol?null:window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+"?p="+t;void 0!==history.pushState&&history.pushState(n,null,r),document.getElementById("title").innerHTML="Pattern Lab - "+t,void 0!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(t))}},popPattern:function(t){var e,n=t.state;if(null===n)return void(this.skipBack=!1);null!==n&&(e=n.pattern);var a="";a=this.getFileName(e),""===a&&(a="styleguide/html/styleguide.html");var o=JSON.stringify({event:"patternLab.updatePath",path:a});document.getElementById("sg-viewport").contentWindow.postMessage(o,urlHandler.targetOrigin),document.getElementById("title").innerHTML="Pattern Lab - "+e,document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(e))}};window.onpopstate=function(t){urlHandler.skipBack=!0,urlHandler.popPattern(t)};var panelsUtil={addClickEvents:function(t,e){for(var n=t.querySelectorAll("#sg-"+e+"-tabs li"),a=0;a<n.length;++a)n[a].onclick=function(t){t.preventDefault();var e=this.getAttribute("data-patternpartial"),n=this.getAttribute("data-panelid");panelsUtil.show(e,n)};return t},show:function(t,e){var n;for(n=document.querySelectorAll("#sg-"+t+"-tabs li"),i=0;i<n.length;++i)n[i].classList.remove("sg-tab-title-active");for(n=document.querySelectorAll("#sg-"+t+"-panels div.sg-tabs-panel"),i=0;i<n.length;++i)n[i].style.display="none";document.getElementById("sg-"+t+"-"+e+"-tab").classList.add("sg-tab-title-active"),document.getElementById("sg-"+t+"-"+e+"-panel").style.display="flex"}},modalStyleguide={active:[],targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,onReady:function(){for(var t=document.querySelectorAll(".sg-pattern-extra-toggle"),e=0;e<t.length;++e)t[e].onclick=function(t){t.preventDefault();var e=this.getAttribute("data-patternpartial");modalStyleguide.toggle(e)}},toggle:function(t){if(void 0!==modalStyleguide.active[t]&&modalStyleguide.active[t])modalStyleguide.close(t);else{var e=document.getElementById("sg-pattern-data-"+t),n=JSON.parse(e.innerHTML);modalStyleguide.patternQueryInfo(n,!0)}},open:function(t,e){var n=document.createElement("div");n.innerHTML=e,e=document.createElement("div").appendChild(n).querySelector("div"),e=panelsUtil.addClickEvents(e,t),modalStyleguide.close(t),modalStyleguide.active[t]=!0,n=document.getElementById("sg-pattern-extra-"+t),n.childNodes.length>0&&n.removeChild(n.childNodes[0]),document.getElementById("sg-pattern-extra-"+t).appendChild(e),document.getElementById("sg-pattern-extra-toggle-"+t).classList.add("active"),document.getElementById("sg-pattern-extra-"+t).classList.add("active")},clean:function(t,e){},close:function(t){modalStyleguide.active[t]=!1,document.getElementById("sg-pattern-extra-toggle-"+t).classList.remove("active"),document.getElementById("sg-pattern-extra-"+t).classList.remove("active")},patternQueryInfo:function(t,e){try{var n=JSON.stringify({event:"patternLab.patternQueryInfo",patternData:t,iframePassback:e});parent.postMessage(n,modalStyleguide.targetOrigin)}catch(a){}},receiveIframeMessage:function(t){var e;if("file:"===window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var n={};try{n="string"!=typeof t.data?t.data:JSON.parse(t.data)}catch(a){}if(void 0!==n.event&&"patternLab.patternQuery"==n.event){var o,i,l,r;for(o=document.querySelectorAll(".sg-pattern-data"),i=o.length>1,e=0;e<o.length;e++)l=JSON.parse(o[e].innerHTML),r=document.querySelector("#"+l.patternPartial+" > .sg-pattern-example"),l.patternMarkup=null!==r?r.innerHTML:document.querySelector("body").innerHTML,modalStyleguide.patternQueryInfo(l,i)}else if(void 0!==n.event&&"patternLab.patternModalInsert"==n.event)modalStyleguide.open(n.patternPartial,n.modalContent);else if(void 0!==n.event&&"patternLab.annotationsHighlightShow"==n.event){var d,s,c,p;for(e=0;e<n.annotations.length;e++)if(c=n.annotations[e],d=document.querySelectorAll(c.el),d.length>0)for(s=0;s<d.length;s++)d[s].classList.add("has-annotation"),p=document.createElement("span"),p.innerHTML=c.displayNumber,p.classList.add("annotation-tip"),"0px"==window.getComputedStyle(d[s],null).getPropertyValue("max-height")&&(p.style.display="none"),annotationTip=document.querySelector(c.el+" > span.annotation-tip"),null===annotationTip?d[s].insertBefore(p,d[s].firstChild):annotationTip.style.display="inline",d[s].onclick=function(t){return function(e){e.preventDefault(),e.stopPropagation();var n=JSON.stringify({event:"patternLab.annotationNumberClicked",displayNumber:t.displayNumber});parent.postMessage(n,modalStyleguide.targetOrigin)}}(c)}else if(void 0!==n.event&&"patternLab.annotationsHighlightHide"==n.event){for(elsToHide=document.querySelectorAll(".has-annotation"),e=0;e<elsToHide.length;e++)elsToHide[e].classList.remove("has-annotation");for(elsToHide=document.querySelectorAll(".annotation-tip"),e=0;e<elsToHide.length;e++)elsToHide[e].style.display="none"}else if(void 0!==n.event&&"patternLab.patternModalClose"==n.event){var g=[];for(var u in modalStyleguide.active)g.push(u);for(e=0;e<g.length;e++){var v=g[e];modalStyleguide.active[v]&&modalStyleguide.close(v)}}}}};modalStyleguide.onReady(),window.addEventListener("message",modalStyleguide.receiveIframeMessage,!1);