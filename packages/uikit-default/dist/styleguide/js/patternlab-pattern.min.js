function receiveIframeMessage(t){if("file:"==window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var e,a={};try{a="string"!=typeof t.data?t.data:JSON.parse(t.data)}catch(n){}if(void 0!==a.event&&"patternLab.updatePath"==a.event)if(void 0!==patternData.patternPartial){var i=/(patterns|snapshots)\/(.*)$/;e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(i,"")+a.path+"?"+Date.now(),window.location.replace(e)}else e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+a.path+"?"+Date.now(),window.location.replace(e);else void 0!==a.event&&"patternLab.reload"==a.event&&window.location.reload()}}if(self!=top){var path=window.location.toString(),parts=path.split("?"),options={event:"patternLab.pageLoad",path:parts[0]};patternData=document.getElementById("pl-pattern-data-footer").innerHTML,patternData=JSON.parse(patternData),options.patternpartial=void 0!==patternData.patternPartial?patternData.patternPartial:"all",""!==patternData.lineage&&(options.lineage=patternData.lineage);var targetOrigin="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);for(var aTags=document.getElementsByTagName("a"),i=0;i<aTags.length;i++)aTags[i].onclick=function(t){var e=this.getAttribute("href"),a=this.getAttribute("target");if(void 0===a||"_parent"!=a&&"_blank"!=a){if(!e||"#"===e)return t.preventDefault(),!1;t.preventDefault(),window.location.replace(e)}else;}}window.addEventListener("message",receiveIframeMessage,!1);var urlHandler={skipBack:!1,targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,getFileName:function(t){var e="patterns",a="";if(void 0===t)return a;if("all"==t)return"styleguide/html/styleguide.html";if("snapshots"==t)return"snapshots/index.html";var n=t.indexOf("viewall-")!=-1?viewAllPaths:patternPaths,i=t.replace("viewall-",""),o=this.getPatternInfo(i,n),l=o[0],r=o[1];if(void 0!==n[l]&&void 0!==n[l][r])a=n[l][r];else if(void 0!==n[l])for(var d in n[l])if(d.indexOf(r)!=-1){a=n[l][d];break}if(""===a)return a;var s=/\//g;return t.indexOf("viewall-")!=-1&&""!==a?a=e+"/"+a.replace(s,"-")+"/index.html":""!==a&&(a=e+"/"+a.replace(s,"-")+"/"+a.replace(s,"-")+".html"),a},getPatternInfo:function(t,e){for(var a=t.split("-"),n=1,i=a.length,o=a[0];void 0===e[o]&&n<i;)o+="-"+a[n],n++;var l=t.slice(o.length+1,t.length);return[o,l]},getRequestVars:function(){var t=new function(t){if(t.length>1)for(var e,a=0,n=t.substr(1).split("&");a<n.length;a++)e=n[a].split("="),this[unescape(e[0])]=e.length>1?unescape(e[1]):""}(window.location.search);return t},pushPattern:function(t,e){var a={pattern:t},n=urlHandler.getFileName(t),i=window.location.pathname;i="file"===window.location.protocol?i.replace("/public/index.html","public/"):i.replace(/\/index\.html/,"/");var o=window.location.protocol+"//"+window.location.host+i+n;if(e!=o){var l=JSON.stringify({event:"patternLab.updatePath",path:n});document.querySelector(".pl-js-iframe").contentWindow.postMessage(l,urlHandler.targetOrigin)}else{var r="file:"==window.location.protocol?null:window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+"?p="+t;void 0!==history.pushState&&history.pushState(a,null,r),document.getElementById("title").innerHTML="Pattern Lab - "+t,void 0!==document.querySelector(".pl-js-open-new-window")&&document.querySelector(".pl-js-open-new-window").setAttribute("href",urlHandler.getFileName(t))}},popPattern:function(t){var e,a=t.state;if(null===a)return void(this.skipBack=!1);null!==a&&(e=a.pattern);var n="";n=this.getFileName(e),""===n&&(n="styleguide/html/styleguide.html");var i=JSON.stringify({event:"patternLab.updatePath",path:n});document.querySelector(".pl-js-iframe").contentWindow.postMessage(i,urlHandler.targetOrigin),document.getElementById("title").innerHTML="Pattern Lab - "+e,document.querySelector(".pl-js-open-new-window").setAttribute("href",urlHandler.getFileName(e))}};window.onpopstate=function(t){urlHandler.skipBack=!0,urlHandler.popPattern(t)};var panelsUtil={addClickEvents:function(t,e){for(var a=t.querySelectorAll(".pl-js-tab-link"),n=0;n<a.length;++n)a[n].onclick=function(t){t.preventDefault();var e=this.getAttribute("data-patternpartial"),a=this.getAttribute("data-panelid");panelsUtil.show(e,a)};return t},show:function(t,e){var a;for(a=document.querySelectorAll("#pl-"+t+"-tabs .pl-js-tab-link"),i=0;i<a.length;++i)a[i].classList.remove("pl-is-active-tab");for(a=document.querySelectorAll("#pl-"+t+"-panels .pl-js-tab-panel"),i=0;i<a.length;++i)a[i].classList.remove("pl-is-active-tab");document.getElementById("pl-"+t+"-"+e+"-tab").classList.add("pl-is-active-tab"),document.getElementById("pl-"+t+"-"+e+"-panel").classList.add("pl-is-active-tab")}},modalStyleguide={active:[],targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,onReady:function(){for(var t=document.querySelectorAll(".pl-js-pattern-extra-toggle"),e=0;e<t.length;++e)t[e].onclick=function(t){var e=this.getAttribute("data-patternpartial");modalStyleguide.toggle(e)}},toggle:function(t){if(void 0!==modalStyleguide.active[t]&&modalStyleguide.active[t])modalStyleguide.highlightsHide(),modalStyleguide.close(t);else{var e=document.getElementById("pl-pattern-data-"+t);modalStyleguide.collectAndSend(e,!0,!1)}},open:function(t,e){var a=document.createElement("div");a.innerHTML=e,e=document.createElement("div").appendChild(a).querySelector("div"),e=panelsUtil.addClickEvents(e,t),modalStyleguide.close(t),modalStyleguide.active[t]=!0,a=document.getElementById("pl-pattern-extra-"+t),a.childNodes.length>0&&a.removeChild(a.childNodes[0]),document.getElementById("pl-pattern-extra-"+t).appendChild(e),document.getElementById("pl-pattern-extra-toggle-"+t).classList.add("pl-is-active"),document.getElementById("pl-pattern-extra-"+t).classList.add("pl-is-active")},close:function(t){modalStyleguide.active[t]=!1,document.getElementById("pl-pattern-extra-toggle-"+t).classList.remove("pl-is-active"),document.getElementById("pl-pattern-extra-"+t).classList.remove("pl-is-active")},collectAndSend:function(t,e,a){var n=JSON.parse(t.innerHTML);void 0!==n.patternName&&(patternMarkupEl=document.querySelector("#"+n.patternPartial+" > .pl-js-pattern-example"),n.patternMarkup=null!==patternMarkupEl?patternMarkupEl.innerHTML:document.querySelector("body").innerHTML,modalStyleguide.patternQueryInfo(n,e,a))},highlightsHide:function(t){var e=void 0!==t?"#"+t+" > ":"";for(elsToHide=document.querySelectorAll(e+".has-annotation"),i=0;i<elsToHide.length;i++)elsToHide[i].classList.remove("has-annotation");for(elsToHide=document.querySelectorAll(e+".annotation-tip"),i=0;i<elsToHide.length;i++)elsToHide[i].style.display="none"},patternQueryInfo:function(t,e,a){try{var n=JSON.stringify({event:"patternLab.patternQueryInfo",patternData:t,iframePassback:e,switchText:a});parent.postMessage(n,modalStyleguide.targetOrigin)}catch(i){}},receiveIframeMessage:function(t){var e;if("file:"===window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var a={};try{a="string"!=typeof t.data?t.data:JSON.parse(t.data)}catch(n){}if(void 0!==a.event&&"patternLab.patternQuery"==a.event){var i,o;for(i=document.querySelectorAll(".pl-js-pattern-data"),o=i.length>1,e=0;e<i.length;e++)modalStyleguide.collectAndSend(i[e],o,a.switchText)}else if(void 0!==a.event&&"patternLab.patternModalInsert"==a.event)modalStyleguide.open(a.patternPartial,a.modalContent);else if(void 0!==a.event&&"patternLab.annotationsHighlightShow"==a.event){var l,r,d,s;for(e=0;e<a.annotations.length;e++)if(d=a.annotations[e],l=document.querySelectorAll(d.el),l.length>0)for(r=0;r<l.length;r++)l[r].classList.add("has-annotation"),s=document.createElement("span"),s.innerHTML=d.displayNumber,s.classList.add("annotation-tip"),"0px"==window.getComputedStyle(l[r],null).getPropertyValue("max-height")&&(s.style.display="none"),annotationTip=document.querySelector(d.el+" > span.annotation-tip"),null===annotationTip?l[r].insertBefore(s,l[r].firstChild):annotationTip.style.display="inline",l[r].onclick=function(t){return function(e){e.preventDefault(),e.stopPropagation();var a=JSON.stringify({event:"patternLab.annotationNumberClicked",displayNumber:t.displayNumber});parent.postMessage(a,modalStyleguide.targetOrigin)}}(d)}else if(void 0!==a.event&&"patternLab.annotationsHighlightHide"==a.event)modalStyleguide.highlightsHide();else if(void 0!==a.event&&"patternLab.patternModalClose"==a.event){var p=[];for(var c in modalStyleguide.active)p.push(c);for(e=0;e<p.length;e++){var u=p[e];modalStyleguide.active[u]&&modalStyleguide.close(u)}}}}};modalStyleguide.onReady(),window.addEventListener("message",modalStyleguide.receiveIframeMessage,!1);